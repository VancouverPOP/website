---
import BrevoMiniForm from './BrevoMiniForm.astro';
---

<button
    id="subscribeBtn"
    class="flex font-raleway gap-2 p-3 h-12 cursor-pointer items-center rounded-xl text-white bg-vp-purple
    hover:-translate-y-0.5 duration-300 hover:shadow-sm hover:opacity-85 hover:shadow-black/50"
>
    <svg
        fill="currentColor"
        class="w-5 h-5"
        viewBox="0 -3 33 33"
        xmlns="http://www.w3.org/2000/svg"
        ><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g
            id="SVGRepo_tracerCarrier"
            stroke-linecap="round"
            stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier">
            <title>envelope</title>
            <path
                d="M28 3.75h-24c-1.794 0.002-3.248 1.456-3.25 3.25v18c0.002 1.794 1.456 3.248 3.25 3.25h24c1.794-0.001 3.249-1.456 3.25-3.25v-18c-0.002-1.794-1.456-3.248-3.25-3.25h-0zM4 6.25h24c0.219 0.001 0.415 0.097 0.549 0.248l0.001 0.001-12.55 8.964-12.55-8.964c0.135-0.152 0.331-0.248 0.549-0.249h0zM28 25.75h-24c-0.414-0-0.75-0.336-0.75-0.75v-15.571l12.023 8.588c0.031 0.018 0.069 0.037 0.108 0.054l0.008 0.003c0.031 0.018 0.068 0.037 0.107 0.054l0.008 0.003c0.145 0.070 0.315 0.113 0.494 0.118l0.002 0h0.002c0.181-0.005 0.351-0.048 0.503-0.121l-0.008 0.003c0.046-0.020 0.084-0.039 0.12-0.060l-0.006 0.003c0.047-0.020 0.085-0.040 0.121-0.061l-0.006 0.003 12.023-8.588v15.571c-0 0.414-0.336 0.75-0.75 0.75v0z"
            ></path>
        </g></svg
    >
    <span>Subscribe</span></button
>
<div id="overlay" class="hidden fixed inset-0 w-screen h-screen bg-black/50 z-51"></div>
<div id="popup" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-52"><BrevoMiniForm /></div>

<script>
    const button = document.getElementById('subscribeBtn');
    const popup = document.getElementById('popup');
    const overlay = document.getElementById('overlay');

    const openModal = () => {
        const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;
        document.body.style.overflow = 'hidden';
        document.body.style.paddingRight = `${scrollbarWidth}px`;
        overlay?.classList.remove('hidden');
        overlay?.classList.add('flex');
        popup?.classList.remove('hidden');
        popup?.classList.add('flex');
    };

    const closeModal = () => {
        overlay?.classList.add('hidden');
        overlay?.classList.remove('flex');
        popup?.classList.add('hidden');
        popup?.classList.remove('flex');
        document.body.style.overflow = '';
        document.body.style.paddingRight = '';
    };

    button?.addEventListener('click', openModal);
    document.addEventListener('keydown', function (event) {
        if (event.key === 'Escape') {
            closeModal();
        }
    });
    overlay?.addEventListener('click', () => {
        closeModal();
    });
</script>
